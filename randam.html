<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è’é‡è¡Œå‹• ç¸›ã‚Šãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  font-family: "Arial", sans-serif;
  background-color: #f2f2f2;
  height: 100%;
  text-align: center;
}
#setup, #roulette {
  display: none;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
#setup.active, #roulette.active {
  display: flex;
}
input {
  padding: 10px;
  margin: 5px;
  font-size: 16px;
  border-radius: 5px;
  border: 1px solid #aaa;
}
button {
  font-size: 18px;
  padding: 10px 20px;
  margin: 10px;
  cursor: pointer;
  border-radius: 5px;
  border: none;
  background-color: #4CAF50;
  color: white;
}
button:hover {
  background-color: #45a049;
}
#result {
  font-size: 6vw;
  padding: 20px;
}
</style>
</head>
<body>

<h1>ğŸ¯ è’é‡è¡Œå‹• ç¸›ã‚Šãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</h1>

<!-- äººæ•°ãƒ»åå‰å…¥åŠ›ç”»é¢ -->
<div id="setup" class="active">
  <div>
    <p>äººæ•°ã‚’é¸æŠï¼ˆæœ€å¤§5äººï¼‰</p>
    <input type="number" id="playerCount" min="1" max="5" value="1">
    <button id="setCountBtn">OK</button>
  </div>
  <div id="nameInputs"></div>
  <button id="saveNamesBtn" style="display:none;">æ¬¡ã¸ â–¶</button>
</div>

<!-- ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆç”»é¢ -->
<div id="roulette">
  <h2 id="currentTitle"></h2>
  <select id="playerSelect"></select>
  <div id="result">çµæœè¡¨ç¤ºã¯ã“ã“</div>
  <button id="shuffleBtn">ç¸›ã‚Šãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ ğŸ²</button>
  <button id="resetBtn" style="background-color:red;">ãƒªã‚»ãƒƒãƒˆ</button>
</div>

<script>
const weapons = [
  "95å¼","G36C","AR18","M4A1","M4A4","SCAR-L","AK-47","SCAR-H","M16A4","AUG","RN94","AK14","M27","81å¼","HK50","AKAIpha","MC-X","ADS","APS",
  "Dual TMP","UZI","MK5","MP5","PP2000","05å¼","ãƒˆãƒ³ãƒ—ã‚½ãƒ³","P90",
  "LSR-8","AWM","CS","AMR-83","Kar98k","M24","ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¯ãƒ","M1891","çˆ†è£‚å¼“","SVD","Val","88å¼","56å¼","ã‚¯ãƒ­ã‚¹ãƒœã‚¦",
  "M860","M88C","SK12",
  "ã‚¬ãƒˆãƒªãƒ³ã‚°ã‚¬ãƒ³","MK60","95å¼è»½æ©Ÿé–¢éŠƒ"
];

const setupDiv = document.getElementById("setup");
const rouletteDiv = document.getElementById("roulette");
const nameInputsDiv = document.getElementById("nameInputs");
const saveNamesBtn = document.getElementById("saveNamesBtn");
const playerSelect = document.getElementById("playerSelect");
const resultDiv = document.getElementById("result");
const titleEl = document.getElementById("currentTitle");

let players = JSON.parse(localStorage.getItem("players")) || [];
let matchCount = parseInt(localStorage.getItem("matchCount")) || 1;

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚
window.onload = () => {
  if (players.length > 0) {
    startRouletteScreen();
  } else {
    setupDiv.classList.add("active");
  }
};

// äººæ•°è¨­å®š
document.getElementById("setCountBtn").addEventListener("click", () => {
  const count = parseInt(document.getElementById("playerCount").value);
  nameInputsDiv.innerHTML = "";
  for (let i = 0; i < count; i++) {
    nameInputsDiv.innerHTML += `<input type="text" id="player${i}" placeholder="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼${i+1}ã®åå‰">`;
  }
  saveNamesBtn.style.display = "inline-block";
});

// åå‰ä¿å­˜
saveNamesBtn.addEventListener("click", () => {
  players = [];
  const count = parseInt(document.getElementById("playerCount").value);
  for (let i = 0; i < count; i++) {
    const name = document.getElementById(`player${i}`).value.trim();
    if (name) players.push({ name, result: null });
  }
  localStorage.setItem("players", JSON.stringify(players));
  localStorage.setItem("matchCount", matchCount);
  startRouletteScreen();
});

// ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆç”»é¢ã«åˆ‡ã‚Šæ›¿ãˆ
function startRouletteScreen() {
  setupDiv.classList.remove("active");
  rouletteDiv.classList.add("active");
  playerSelect.innerHTML = players.map(p => `<option value="${p.name}">${p.name}</option>`).join("");
  titleEl.textContent = `${matchCount}è©¦åˆç›®`;
}

// ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ
function pickUniqueRandom(arr, count) {
  const copy = arr.slice();
  const picked = [];
  for (let i = 0; i < count; i++) {
    const idx = Math.floor(Math.random() * copy.length);
    picked.push(copy.splice(idx, 1)[0]);
  }
  return picked;
}

// ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆå®Ÿè¡Œ
document.getElementById("shuffleBtn").addEventListener("click", () => {
  const selectedName = playerSelect.value;
  const player = players.find(p => p.name === selectedName);
  const pickCount = Math.random() < 0.5 ? 1 : 2;
  const finalPicked = pickUniqueRandom(weapons, pickCount);

  if (player.result) {
    // 2å›ç›®ä»¥é™ï¼šç½°ã‚²ãƒ¼ãƒ 
    resultDiv.innerHTML = `âš ï¸ ${player.name}ã¯2å›ç›®ï¼ç½°ã‚²ãƒ¼ãƒ ï¼<br>æ–°ã—ã„ç¸›ã‚Šã«ä¸Šæ›¸ãã•ã‚Œã¾ã—ãŸğŸ’€<br><br>1. ${finalPicked[0]}<br>2. ${finalPicked[1] || "è‡ªç”±"}`;
  } else {
    // åˆå›
    resultDiv.innerHTML = `${player.name}ã®ç¸›ã‚Šï¼š<br>1. ${finalPicked[0]}<br>2. ${finalPicked[1] || "è‡ªç”±"}`;
  }

  // çµæœä¿å­˜
  player.result = finalPicked;
  localStorage.setItem("players", JSON.stringify(players));
});

// ãƒªã‚»ãƒƒãƒˆ
document.getElementById("resetBtn").addEventListener("click", () => {
  localStorage.clear();
  location.reload();
});
</script>

</body>
</html>
