<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è’é‡è¡Œå‹• ç¸›ã‚Šãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</title>
<style>
html, body {height: 100%;margin: 0;font-family: Arial, sans-serif;background: #f2f2f2;}
#setup, #roulette, #allResults, #punishmentsContainer {display: none;flex-direction: column;justify-content: center;align-items: center;height: 100vh;}
#result {font-size: 6vw;text-align: center;padding: 20px;background: #fff;border-radius: 10px;margin-bottom: 20px;box-shadow: 0 4px 8px rgba(0,0,0,0.15);}
button {font-size: 18px;padding: 12px 25px;margin: 10px;cursor: pointer;border: none;border-radius: 6px;background: #4CAF50;color: white;}
button:hover {background: #45a049;}
input {font-size: 18px;margin: 5px;padding: 8px;}
#currentPlayer {font-size: 2em;color: #222;margin: 10px 0 5px 0;text-align: center;}
#matchInfo {font-size: 1.5em;color: #555;margin-bottom: 15px;text-align: center;}
.resultBox {background: #fff;border-radius: 8px;padding: 10px;margin: 10px auto;width: 80%;box-shadow: 0 2px 6px rgba(0,0,0,0.1);text-align: center;font-size: 1.5em;}
.resultBox h3 {margin: 0 0 5px 0;}
#backBtn, #closePunishmentsBtn {background: #f44336;}
#backBtn:hover, #closePunishmentsBtn:hover {background: #d32f2f;}
#resultsContainer, #punishmentsContent {width: 90%;max-height: 80vh;overflow-y: auto;}
#playerCount {width: 20%;}
#modeButtons button {background:#2196F3;}
#modeButtons button:hover {background:#1976D2;}
</style>
</head>
<body>

<!-- è¨­å®šç”»é¢ -->
<div id="setup">
  <h2>ğŸ® äººæ•°ã‚’å…¥åŠ›ï¼ˆæœ€å¤§5äººï¼‰</h2>
  <input type="number" id="playerCount" min="1" max="5" placeholder="äººæ•°ã‚’å…¥åŠ› (1ã€œ5)">
  <button id="setPlayers">æ±ºå®š</button>
  <div id="nameInputs"></div>
  <button id="startBtn" style="display:none;">ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã¸é€²ã‚€</button>
</div>

<!-- ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆç”»é¢ -->
<div id="roulette">
  <div id="modeButtons" style="margin-bottom:10px;">
    <button class="modeBtn" data-mode="normal">é€šå¸¸</button>
    <button class="modeBtn" data-mode="team">å›£ä½“</button>
    <button class="modeBtn" data-mode="menst">ãƒ¡ãƒ³ã‚¹ãƒˆ</button>
  </div>
  <h1>ğŸ¯ è’é‡è¡Œå‹• ç¸›ã‚Šãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</h1>
  <h2 id="currentPlayer"></h2>
  <div id="matchInfo"></div>
  <div id="result">çµæœè¡¨ç¤ºã¯ã“ã“</div>
  <button id="shuffleBtn">ç¸›ã‚Šãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ ğŸ²</button>
  <button id="nextPlayerBtn" style="display:none;">æ¬¡ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¸ â¡</button>
  <button id="nextMatchBtn" style="display:none;">æ¬¡ã®è©¦åˆã¸ ğŸ</button>
  <button id="viewResultBtn">çµæœä¸€è¦§ã‚’è¦‹ã‚‹ ğŸ“‹</button>
  <button id="showPunishmentsBtn">ç½°ã‚²ãƒ¼ãƒ ä¸€è¦§ã‚’è¦‹ã‚‹ ğŸ¯</button>
  <button id="shareBtn">çµæœã‚’å…±æœ‰ã™ã‚‹ ğŸ”—</button>
</div>

<!-- çµæœä¸€è¦§ -->
<div id="allResults">
  <h2>ğŸ“‹ çµæœä¸€è¦§</h2>
  <div id="resultsContainer"></div>
  <button id="backBtn">Ã— é–‰ã˜ã‚‹</button>
</div>

<!-- ç½°ã‚²ãƒ¼ãƒ ä¸€è¦§ -->
<div id="punishmentsContainer">
  <h2>ğŸ¯ ç½°ã‚²ãƒ¼ãƒ ä¸€è¦§</h2>
  <div id="punishmentsContent"></div>
  <button id="closePunishmentsBtn">Ã— é–‰ã˜ã‚‹</button>
</div>

<script>
const setupDiv=document.getElementById("setup");
const rouletteDiv=document.getElementById("roulette");
const allResultsDiv=document.getElementById("allResults");
const punishmentsDiv=document.getElementById("punishmentsContainer");
const playerCountInput=document.getElementById("playerCount");
const nameInputsDiv=document.getElementById("nameInputs");
const startBtn=document.getElementById("startBtn");
const shuffleBtn=document.getElementById("shuffleBtn");
const nextPlayerBtn=document.getElementById("nextPlayerBtn");
const nextMatchBtn=document.getElementById("nextMatchBtn");
const currentPlayerLabel=document.getElementById("currentPlayer");
const matchInfo=document.getElementById("matchInfo");
const resultDiv=document.getElementById("result");
const viewResultBtn=document.getElementById("viewResultBtn");
const showPunishmentsBtn=document.getElementById("showPunishmentsBtn");
const resultsContainer=document.getElementById("resultsContainer");
const punishmentsContent=document.getElementById("punishmentsContent");
const backBtn=document.getElementById("backBtn");
const closePunishmentsBtn=document.getElementById("closePunishmentsBtn");
const shareBtn=document.getElementById("shareBtn");
const modeBtns=document.querySelectorAll(".modeBtn");

const weapons=[
 "95å¼","G36C","AR18(89å¼)","M4A1","M4A4","SCAR-L","AK-47","SCAR-H","M16A4","AUG","RN94","AK14","M27","81å¼","HK50","AKAIpha","MC-X","ADS","APS",
 "Dual TMP","UZI","MK5","MP5","PP2000","05å¼","ãƒˆãƒ³ãƒ—ã‚½ãƒ³","P90",
 "LSR-8","AWM","CS","AMR-83","Kar98k","M24","ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¯ãƒ","M1891","çˆ†è£‚å¼“","SVD","Val","88å¼","56å¼","ã‚¯ãƒ­ã‚¹ãƒœã‚¦",
 "M860","M88C","SK12",
 "ã‚¬ãƒˆãƒªãƒ³ã‚°ã‚¬ãƒ³","MK60","95å¼è»½æ©Ÿé–¢éŠƒ"
];
//å›£ä½“
const weapons2 = [
 "95å¼","G36C","M4A1","M4A4","SCAR-L","AK-47","SCAR-H","M16A4","AUG","RN94","AK14","M27","81å¼","HK50","AKAIpha","MC-X",
 "Dual TMP","UZI","MK5","MP5","PP2000","05å¼","P90",
 "AWM","CS","AMR-83","M24","çˆ†è£‚å¼“","SVD",
 "M860","M88C","SK12"
];
//ãƒ¡ãƒ³ã‚¹ãƒˆ
const weapons3 = [
 "95å¼","G36C","M4A1","M4A4","SCAR-L","AK-47","SCAR-H","M16A4","AUG","RN94","AK14","M27","81å¼","HK50","AKAIpha","MC-X",
 "Dual TMP","UZI","MK5","MP5","PP2000","05å¼","P90",
 "AWM","CS","AMR-83","M24","çˆ†è£‚å¼“","SVD",
 "M860","M88C","SK12"
];
const bgColors=["#fff","#f9f0f0","#f0f9f9","#f0f0f9","#f9f9f0","#f8f0f8","#f0f8f0","#f8f8f0","#f0f0f8"];

let players=[];
let currentPlayerIndex=0;
let currentMatch=1;
let results=JSON.parse(localStorage.getItem("results"))||{};
let punishments=JSON.parse(localStorage.getItem("punishments"))||{};
let currentMode=localStorage.getItem("mode")||"normal";
const modeTitles={normal:"ğŸ¯ è’é‡è¡Œå‹• ç¸›ã‚Šãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆï¼ˆé€šå¸¸ï¼‰",team:"ğŸ¯ è’é‡è¡Œå‹• ç¸›ã‚Šãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆï¼ˆå›£ä½“ï¼‰",menst:"ğŸ¯ è’é‡è¡Œå‹• ç¸›ã‚Šãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆï¼ˆãƒ¡ãƒ³ã‚¹ãƒˆï¼‰"};

// ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
modeBtns.forEach(btn=>btn.addEventListener("click",()=>setMode(btn.dataset.mode)));
function setMode(mode){
 currentMode=mode;
 localStorage.setItem("mode",mode);
 rouletteDiv.querySelector("h1").textContent=modeTitles[mode];
 displayResult();
}

// ãƒ¢ãƒ¼ãƒ‰ã«å¿œã˜ãŸæ­¦å™¨é…åˆ—
function getWeaponArray(){
 if(currentMode==="normal") return weapons;
 if(currentMode==="team") return weapons2;
 if(currentMode==="menst") return weapons3;
 return weapons;
}

// ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆæ¼”å‡º
shuffleBtn.onclick=async ()=>{
 const name=players[currentPlayerIndex];
 const key=`è©¦åˆ${currentMatch}`;
 results[key]=results[key]||{};
 const weaponsArr=getWeaponArray();
 await spinRoulette(2000);
 const weapon1=weaponsArr[Math.floor(Math.random()*weaponsArr.length)];
 const weapon2=weaponsArr[Math.floor(Math.random()*weaponsArr.length)];
 let resultText=`${weapon1}, ${weapon2}`;
 if(results[key][name] && confirm("ç½°ã‚²ãƒ¼ãƒ ã‚’å…¥åŠ›ã—ã¾ã™ã‹ï¼Ÿ")){
   const punishment=prompt("ç½°ã‚²ãƒ¼ãƒ ã‚’å…¥åŠ›");
   if(punishment){resultText+=` (ç½°ã‚²ãƒ¼ãƒ :${punishment})`; punishments[name]=punishments[name]||[]; punishments[name].push(`è©¦åˆ${currentMatch}ï¼š${punishment}`);}
 }
 results[key][name] = resultText;
 localStorage.setItem("results",JSON.stringify(results));
 localStorage.setItem("punishments",JSON.stringify(punishments));
 resultDiv.textContent=`${name} ã®çµæœï¼š${results[key][name]}`;
 if(currentPlayerIndex<players.length-1){nextPlayerBtn.style.display="inline-block";nextMatchBtn.style.display="none";}
 else{nextPlayerBtn.style.display="none";nextMatchBtn.style.display="inline-block";}
}

function spinRoulette(duration=2000){
 return new Promise(resolve=>{
   shuffleBtn.disabled=true;
   const interval=setInterval(()=>{
     const w1=getWeaponArray()[Math.floor(Math.random()*getWeaponArray().length)];
     const w2=getWeaponArray()[Math.floor(Math.random()*getWeaponArray().length)];
     resultDiv.textContent=`ğŸ”„ ${w1}, ${w2}`;
   },100);
   setTimeout(()=>{
     clearInterval(interval);
     shuffleBtn.disabled=false;
     resolve();
   },duration);
 });
}

// æ¬¡ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼
nextPlayerBtn.onclick=()=>{
 currentPlayerIndex++;
 if(currentPlayerIndex>=players.length){nextPlayerBtn.style.display="none";nextMatchBtn.style.display="inline-block";}
 else{updatePlayerDisplay(); resultDiv.textContent="çµæœè¡¨ç¤ºã¯ã“ã“"; nextPlayerBtn.style.display="none";}
};

// æ¬¡ã®è©¦åˆ
nextMatchBtn.onclick=()=>{currentMatch++; currentPlayerIndex=0; resultDiv.textContent="çµæœè¡¨ç¤ºã¯ã“ã“"; nextMatchBtn.style.display="none"; updatePlayerDisplay(); localStorage.setItem("currentMatch",currentMatch);}

// çµæœè¡¨ç¤º
viewResultBtn.onclick=()=>{
 rouletteDiv.style.display="none";
 allResultsDiv.style.display="flex";
 resultsContainer.innerHTML="";
 let colorIndex=0;
 for(const [match,playersData] of Object.entries(results)){
   const box=document.createElement("div");box.className="resultBox";box.style.background=bgColors[colorIndex++%bgColors.length];
   const h3=document.createElement("h3");h3.textContent=match;box.appendChild(h3);
   for(const [name,result] of Object.entries(playersData)){
     const p=document.createElement("p");p.textContent=`ğŸ‘¤ ${name} ğŸ”« ${result}`;box.appendChild(p);
   }
   resultsContainer.appendChild(box);
 }
};

// ç½°ã‚²ãƒ¼ãƒ ä¸€è¦§
showPunishmentsBtn.onclick=()=>{
 rouletteDiv.style.display="none";
 punishmentsDiv.style.display="flex";
 punishmentsContent.innerHTML="";
 let colorIndex=0;
 for(const [name,list] of Object.entries(punishments)){
   const box=document.createElement("div");box.className="resultBox";box.style.background=bgColors[colorIndex++%bgColors.length];
   const h3=document.createElement("h3");h3.textContent=name;box.appendChild(h3);
   list.forEach(item=>{const p=document.createElement("p");p.textContent=item;box.appendChild(p);});
   punishmentsContent.appendChild(box);
 }
};

// é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
backBtn.onclick=()=>{allResultsDiv.style.display="none"; rouletteDiv.style.display="flex";}
closePunishmentsBtn.onclick=()=>{punishmentsDiv.style.display="none"; rouletteDiv.style.display="flex";}

// å…±æœ‰
shareBtn.onclick=()=>{
 const data={players,results,punishments,currentMatch};
 const encoded=encodeURIComponent(JSON.stringify(data));
 const url=`${location.origin}${location.pathname}?data=${encoded}`;
 navigator.clipboard.writeText(url).then(()=>alert("URLã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼")).catch(()=>alert("ã‚³ãƒ”ãƒ¼å¤±æ•—"));
}

// ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡¨ç¤ºæ›´æ–°
function updatePlayerDisplay(){const name=players[currentPlayerIndex]; currentPlayerLabel.textContent=`ğŸ® ç¾åœ¨ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼š${name}`; matchInfo.textContent=`è©¦åˆ ${currentMatch}`}

// åå‰å…¥åŠ›å‡¦ç†
document.getElementById("setPlayers").onclick=setPlayerInputs;
playerCountInput.addEventListener("keydown",e=>{if(e.key==="Enter") setPlayerInputs();});
function setPlayerInputs(){const count=parseInt(playerCountInput.value);if(isNaN(count)||count<1||count>5){alert("äººæ•°ã¯1ã€œ5äºº");return;}nameInputsDiv.innerHTML="";for(let i=0;i<count;i++){const input=document.createElement("input");input.placeholder=`ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼${i+1}ã®åå‰`;input.id=`player${i}`;nameInputsDiv.appendChild(input);input.addEventListener("keydown",e=>{if(e.key==="Enter") startBtn.click();});}startBtn.style.display="block";}
startBtn.onclick=()=>{players=[];for(let i=0;i<parseInt(playerCountInput.value);i++){const val=document.getElementById(`player${i}`).value.trim();if(!val){alert("å…¨å“¡ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");return;}players.push(val);}setupDiv.style.display="none";rouletteDiv.style.display="flex";updatePlayerDisplay();setMode(currentMode);}
</script>
</body>
</html>

